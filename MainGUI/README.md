# LSL Main Graphical User Interface
Main Graphical User interface for launching LSL-related applications.
## Prerequisites
### Minimum install
The following modules are necessary for a basic installation that allows running LSL device applications.
* The following modules come out-of-the-box with a default [Anaconda](https://www.anaconda.com/) installation:
  * Python >= 3.5 (tested on Python 3.7.6)
  * [PyQt5](https://pypi.org/project/PyQt5/): Python bindings for the Qt application toolkit
  * [Qtpy](https://pypi.org/project/QtPy/): Abstraction layer on top of the Qt bindings.
* [`liblsl`](https://github.com/sccn/labstreaminglayer/wiki/INSTALL) built from source code.
* [`pylsl`](https://labstreaminglayer.readthedocs.io/dev/app_dev.html#python-apps): Python interface for the Lab Streaming Layer (LSL).
### Recommended install
The following modules are necessary for working with some specific applications that the Main GUI gives access to. Therefore, to avoid compatibility issues it is recommended to have them installed.
* [`numpy`](https://pypi.org/project/numpy/): Library for array computing. Comes by default with Anaconda.
* [`scipy`](https://pypi.org/project/scipy/): Scientific Library for Python. Used for signal filtering. Comes by default with Anaconda.
* A data visualization library like [`pyqtgraph`](https://pypi.org/project/pyqtgraph/or [`matplotlib`](https://pypi.org/project/matplotlib/). Both come by default with Anaconda.
### Optional install
The following modules are required for a complete, full installation. They allow a full control of the supported software.
* [`liblsl-Matlab`](https://github.com/labstreaminglayer/liblsl-Matlab): MATLAB interface for Lab Streaming Layer to allow the usage of the Matlab Viewer and the XDF load functions. Requires a MATLAB installation.
  * [MATLAB engine for Python](https://www.mathworks.com/help/matlab/matlab_external/install-the-matlab-engine-for-python.html): To allow running MATLAB functions from Python. Not strictly necessary, since in its absence MATLAB functions will be called from the OS command window.
* [`keyboard`](https://pypi.org/project/keyboard/): keyboard detection module for Python to allow the usage of shortcuts. Warning: usage of the Keyboard in Linux and MacOS requires sudo privileges.

## Usage
* Run `maingui.py`. A window with the different available applications will appear. Each application runs in a different subprocess, therefore, several applications can be run at the same time.
* Applications are divided in several groups: 
  * Linker applications: they are in charge of fetching data from laboratory devices and streaming it to the Lab Streaming Layer.
  * Recording/processing tools: applications that are able to record online data to a file and/or processing it. The most important one is the [Lab Recorder](https://github.com/labstreaminglayer/App-LabRecorder).
  * Viewer tools: applications devoted to show online data, either from continuous or discrete streams.
  * Test tools: applications that are used for debug purposes, such as signal generators/receivers, Mouse/Keyboard hookers, etc.
  * Uncategorized tools: applications that do not belong to any of the previously mentioned categories.
* Choose between the different applications. The application needs to be built on the computer. For more information on building applications, see this [link](https://github.com/sccn/labstreaminglayer/wiki/INSTALL).
* Information about the group that each application belongs to, as well as its install path, is stored in the `config.json` file. If this file is deleted, it will be automatically regenerated by the program.
* If the executable file of the application is not found on the computer, a file selector will appear, asking the user to specify its correct location. This new location will be saved in the `config.json` file.
* For information regarding the MATLAB Viewer please refer to the section "Using the MATLAB Viewer".

## Adding custom applications to the Main GUI
There is no graphical solution developed for manually adding an application to the Main GUI, but the following procedure can be easily followed:
1. Open `config.json` with your favourite text editor.
2. This file contains information regarding the applications in the form of a Python dictionary. The key is associated to identify the application, and the value is another dictionary that contains the following fields:
   * `"path"`: String path to the executable file if it is a Python script or a universal executable script. If it is a single OS-exclusive application, fields `"winpath"`, `"linpath"` and `"macpath"` are used to distinguish between different builds of the application.
   * `"name"`: String to be displayed at the GUI button.
   * `"group"`: Group that the application belongs to. `"app"` for linker applications, `"process_record"` for processing/recording applications, `"viewer"` for viewer applications and `"test"` for testing applications. If none of these names is specified, the Main GUI will classify the application in the Uncategorized group.
   * `"func"`: Name of the function that is run when the button associated to each application is pressed. Normally, for an executable file that does not require additional Python configuration to be run the required value is `"default"`. In such case, when the button is pressed a subprocess associated to the executable file will be created.
Modify these fields according to the new application's needs and save changes.
3. Consider adding these changes to the `createDefaultConfigFile()` function in the `gui_config.py` script, so that if any error leads to the creation of a default configuration file this new configuration is not lost.

## Using the MATLAB Viewer
To preserve the structure of the vis_stream.m MATLAB function and enable compatibility with the Main GUI, some files need to copied to the MATLAB Viewer directory. The procedure is as follows:
1. In the same directory as the Main GUI (the current directory) you will find a folder called `utils`. Inside there are two files: `matlab_viewer_launch.py` and `misc_utils.py`.
2. Copy these files into the MATLABViewer directory. If you use the [Apps,MainGUI,OnlinePlotter,OnlineProcessing] structure, the MATLABViewer is in the `OnlinePlotter` directory. If you use the traditional structure, the MATLABViewer is in the `Apps` directory. In both cases compatibility is ensured. For other configuration or out of tree builds you will need to change the path of the LSL main library in the `matlab_viewer_launch.py` and the `misc_utils.py` script. Do not copy the folder, only the scripts.


###### 